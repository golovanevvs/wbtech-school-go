# План реализации mygrep

## Этапы реализации

### ✅ Этап 1: Базовый CLI grep (ЗАВЕРШЁН)
- ✅ Парсинг аргументов командной строки
- ✅ Реализация локального grep с поддержкой флагов
- ✅ Чтение файлов/потоков

### ✅ Этап 2: Сетевое взаимодействие (ЧАСТИЧНО ЗАВЕРШЁН)
- ✅ HTTP/TCP сервер для обмена сообщениями
- ✅ Регистрация серверов в кластере
- ✅ Обмен статусом между серверами
- ⏳ Обработка заданий (в разработке)

### Этап 3: Распределение данных (В РАЗРАБОТКЕ)
- Разбиение входных данных на части
- Отправка заданий другим серверам
- Сбор результатов

### Этап 4: Кворум и конкурентность
- Алгоритм достижения кворума (N/2+1)
- Параллельная обработка с горутинами
- Каналы для синхронизации

### Этап 5: Тестирование и документация
- Сравнение с оригинальным grep
- Примеры использования
- Инструкции по запуску

## Использование

### Локальный режим (как обычный grep)
```bash
./mygrep -n "pattern" file.txt
```

### Distributed режим
```bash
# Запуск сервера на порту 8080
./mygrep -n "pattern" file.txt -port=8080

# Запуск с подключением к пирам
./mygrep -n "pattern" file.txt -port=8080 -peers="localhost:8081,localhost:8082"

# С указанием server-id
./mygrep -n "pattern" file.txt -port=8080 -server-id="server1:8080" -peers="server2:8081"
```

## Поддерживаемые флаги

### Основные флаги grep
- `-n` - показать номера строк
- `-v` - инвертировать совпадения
- `-i` - игнорировать регистр
- `-x` - искать только полные строки
- `-c` - показать только количество совпадений
- `-o` - показать только совпадающие части
- `--color` - выделить совпадения цветом

### Distributed флаги
- `-port` - порт для distributed режима
- `-peers` - список пиров (через запятую)
- `-server-id` - идентификатор сервера

## Архитектура

### Текущая реализация
```
├── cmd/mygrep/main.go         # Точка входа
├── internal/app/app.go        # Основная логика + сетевой сервер
└── internal/model/model.go    # Структуры данных
```

### Сетевое взаимодействие
- TCP сервер для приёма входящих соединений
- JSON сообщения для обмена данными
- Поддержка status_request/status_response
- Заглушки для job_request/job_response

## Текущий статус

✅ **Этап 1**: Базовый CLI grep полностью реализован и протестирован
✅ **Этап 2**: Сетевая инфраструктура создана (сервер, клиент, сообщения)
⏳ **Этап 3**: В разработке - нужно реализовать разбиение данных и обработку заданий