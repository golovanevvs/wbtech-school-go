# sales-tracker

**SalesTracker** — CRUD с аналитикой и агрегированием данных

Во многих сервисах нужно не просто хранить записи (например, транзакции, заказы, события), но и уметь анализировать их: смотреть сумму продаж за период, количество заказов в день, средний чек, медиану, перцентиль и т.п. Это может быть полезно в личных финансовых приложениях, системах учёта заказов, внутренних CRM-инструментах и многих других случаях.

В этом задании вы реализуете сервис, который умеет не только выполнять CRUD-операции (создание, обновление, удаление и просмотр записей), но и собирать по этим данным аналитику: рассчитывать суммы, средние значения, медианы, перцентили и т.д. Такая задача — отличная тренировка в работе с SQL-запросами и обработкой данных.

Все данные должны храниться в PostgreSQL. Для агрегации, фильтрации, расчёта медианы и перцентилей (с помощью оконных функций или подзапросов) нужно использовать SQL-запросы. Данные желательно валидировать (например, сумма не может быть отрицательной, дата должна быть валидной и т.п.). Не забывайте про SQL-инъекции. Важно уметь писать быстрые и эффективные запросы к БД, но если на этом этапе не получается — напишите как есть, плохой результат лучше отсутствия отличного.

## Требования

Сервис должен поддерживать:

- встроенные HTTP-методы:
  - CRUD-операции (например, финансовые транзакции или продажи);
    - `POST /items`;
    - `GET /items`;
    - `PUT /items/{id}`;
    - `DELETE /items/{id}`.

- возможность получения агрегированной аналитики:
  - сумма (sum);
  - среднее (avg);
  - количество (count);
  - медиана;
  - 90-й перцентиль.

Например:

`GET /analytics?from={}&to={}`

Сделайте простой веб-интерфейс, где можно:

- добавлять новые записи (например, "доход", "расход", сумма, дата, категория);

- просматривать таблицу всех записей с фильтрами;

- получать сводную аналитику за период (график или просто числа);

- скачивать данные в CSV (если реализовано).

Интерфейс можно реализовать даже на HTML + JS (без фреймворков), главное — чтобы работали все основные сценарии.

Дополнительно (будет плюсом):

- экспорт отчётов в CSV;

- возможность сортировки по различным полям;

- возможность группировки по дням, неделям, категориям и т.д.

## План реализация

- sales-tracker_main-server - api-сервер на Go;
- sales-tracker_web-client - web-клиент на next.js.

### web-клиент (next.js)

- Header общий для всех страниц:
  - название "Sales Tracker" -> переход на страницу "Главная" (`/`);
  - кнопка переключения темы (светлая/тёмная);
- Footer общий для всех страниц:
  - текст, содержащий контакты разработчика (Telegram username);
- страница "Главная" (`/`):
  - кнопка "Добавить запись" -> переход на страницу "Добавление записи" (`/add_item`);
  - кнопка "Посмотреть все записи" -> переход на страницу "Список записей" (`/items`);
  - кнопка "Получить аналитику" -> переход на страницу "Просмотр аналитики" (`/analytics`);
  - кнопка "Скачать CSV" -> переход на страницу "Скачать CSV";
- страница "Добавление записи" (`/add_item`):
  - поле "Тип" (доход, расход);
  - поле "Категория";
  - поле "Дата";
  - поле "Сумма";
  - кнопка "Добавить запись" -> `POST /items`, отображается сообщение о результате операции на сервере, если успех - данные на форме сбрасываются для ввода следующей записи;
  - кнопка "Отмена";
- страница "Список записей" (`/items`):
  - получение данных с сервера (`GET /items`), отсортированных по полю `ID`;
  - поле для выбора поля для сортировки:
    - "ID", "Тип", "Категория", "Дата", "Сумма";
  - поле для выбора "по возрастанию"/"по убыванию";
  - кнопка "Сортировать" (данные должны сортироваться на сервере, клиент получает уже отсортированные данные, для этого необходимо предусмотреть дополнительные api, при нажатии на кнопку таблица обновляется);
  - таблица (material react table):
    - поля: "ID","Тип", "Категория", "Дата", "Сумма";
    - у каждой строки должны быть кнопки "Удалить" и "Редактировать":
      - кнопка "Удалить" -> `DELETE /items/{id}`, отображается сообщение о результате операции на сервере, таблица обновляется (`GET /items`);
      - кнопка "Редактировать" -> поля в таблице становятся доступными для редактирования, после завершения редактирования поля - `PUT /items/{id}`, отображается сообщение о рещультате операции на сервере, таблица обновляется (`GET /items`);
- страница "Просмотр аналитики":
  - поле "Дата начала";
  - поле "Дата окончания";
  - кнопка "Посмотреть аналитику" -> `GET /analytics?from={}&to={}`;
  - форма для отображения аналитики:
    - график (material react chart);
    - поле для отображения суммы за заданный период (sum);
    - поле для отображения среднего значения за заданный период (avg);
    - поле для отоборажения количества записей (count) за заданный период;
    - поле для отображения медианы за заданный период;
    - поле для отображения 90-го перцентиля за заданный период.
