# L1.15 Небольшой фрагмент кода — проблемы и решение

Рассмотреть следующий код и ответить на вопросы: к каким негативным последствиям он может привести и как это исправить?

Приведите корректный пример реализации.

```go
var justString string

func someFunc() {
  v := createHugeString(1 << 10)
  justString = v[:100]
}

func main() {
  someFunc()
}
```

Вопрос: что происходит с переменной justString?

## Ответ

Строка в Go - это структура, которая содержит в себе указатель на массив байт и длину. В случае `justString = v[:100]` создаётся новая строка, но она ссылается на тот же базовый массив `v`, т.е. ссылка удерживает весь массив в памяти и не позволяет сборщику мусора освободить её, таким образом происходит **утечка памяти**. Чтобы этого избежать нужно создать отдельную копию необходимых данных `justStringNew = strings.Clone(v[:100])`, тогда прежний массив `v` будет почищен сборщиком мусора. Дополнительно, возможно, стоит учесть, что если необходимо получить строку из 100 символов, то необходимо будет перевести её в срез рун.
